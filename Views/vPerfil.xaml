<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="KynosPetClub.Views.vPerfil"
             Title="Perfil">
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            <!-- Hora (simulada) -->
            <Label Text="{Binding CurrentTime, StringFormat='{0:HH:mm}'}"
                   FontSize="16"
                   TextColor="Black"
                   HorizontalOptions="End"/>

            <!-- Saludo -->
            <Label x:Name="lblSaludo"
                   FontSize="24"
                   FontAttributes="Bold"
                   TextColor="Black"/>

            <!-- Información del usuario -->
            <Frame BackgroundColor="#F7F7F7" 
                   Padding="15"
                   CornerRadius="10" 
                   HasShadow="False">
                <VerticalStackLayout Spacing="10">
                    <Label x:Name="lblNombre"
                           FontSize="18"
                           FontAttributes="Bold"/>
                    <Label x:Name="lblCorreo"
                           FontSize="14"
                           TextColor="Gray"/>
                    <Label x:Name="lblFechaNac"
                           FontSize="14"
                           TextColor="Gray"/>

                    <!-- Botón Editar Perfil -->
                    <Button x:Name="btnEditarPerfil"
                            Text="Editar Perfil"
                            BackgroundColor="Transparent"
                            TextColor="#007AFF"
                            BorderColor="#007AFF"
                            BorderWidth="1"
                            CornerRadius="5"
                            HorizontalOptions="Start"
                            Padding="10,5"
                            FontSize="14"
                            HeightRequest="35"
                            Clicked="btnEditarPerfil_Clicked"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Sección de mascotas -->
            <Label Text="Tus Mascotas"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="Black"/>

            <!-- CollectionView para mascotas -->
            <CollectionView x:Name="cvMascotas"
                           SelectionMode="None"
                           HeightRequest="250">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical" 
                                    Span="2"
                                    VerticalItemSpacing="10"
                                    HorizontalItemSpacing="10"/>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame CornerRadius="10" 
                               HasShadow="True" 
                               Padding="10"
                               HeightRequest="160"
                               MinimumWidthRequest="160">
                            <VerticalStackLayout Spacing="8">
                                <Image Source="{Binding Especie, Converter={StaticResource EspecieToImageConverter}}"
                                       HeightRequest="60"
                                       WidthRequest="60"
                                       HorizontalOptions="Center"/>

                                <Label Text="{Binding Nombre}" 
                                       FontSize="14" 
                                       FontAttributes="Bold"
                                       HorizontalOptions="Center"/>

                                <Label Text="{Binding FechaNacimiento, StringFormat='Nac: {0:dd/MM/yyyy}'}"
                                       FontSize="12"
                                       TextColor="Gray"
                                       HorizontalOptions="Center"/>

                                <Grid ColumnDefinitions="*,*" 
                                      RowDefinitions="Auto"
                                      HorizontalOptions="Fill"
                                      VerticalOptions="End">
                                    <Button Grid.Column="0"
                                            Text="Editar"
                                            BackgroundColor="#FFC107"
                                            TextColor="Black"
                                            CornerRadius="5"
                                            Margin="0,0,5,0"
                                            FontSize="12"
                                            HeightRequest="30"
                                            CommandParameter="{Binding .}"
                                            Clicked="btnEditarMascota_Clicked"/>

                                    <Button Grid.Column="1"
                                            Text="Eliminar"
                                            BackgroundColor="#FF5252"
                                            TextColor="White"
                                            CornerRadius="5"
                                            Margin="5,0,0,0"
                                            FontSize="12"
                                            HeightRequest="30"
                                            CommandParameter="{Binding .}"
                                            Clicked="btnEliminarMascota_Clicked"/>
                                </Grid>
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Botón Añadir Mascota -->
            <Button x:Name="btnAgregarMascota"
                    Text="+ Añadir mascota"
                    BackgroundColor="#9EFFAC"
                    TextColor="Black"
                    CornerRadius="10"
                    FontAttributes="Bold"
                    HeightRequest="45"
                    Clicked="btnAgregarMascota_Clicked"/>

            <!-- Configuración -->
            <Frame BackgroundColor="#F7F7F7"
                   Padding="15"
                   CornerRadius="10"
                   HasShadow="False">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Configuración"
                           FontSize="18"
                           FontAttributes="Bold"/>

                    <HorizontalStackLayout Spacing="10">
                        <Image Source="notification_icon.png"
                               HeightRequest="24"/>
                        <Label Text="Notificaciones"
                               VerticalOptions="Center"/>
                        <Switch IsToggled="True"
                                HorizontalOptions="EndAndExpand"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Botón Cerrar Sesión -->
            <Button x:Name="btnCerrarSesion"
                    Text="Cerrar Sesión"
                    TextColor="Red"
                    BackgroundColor="Transparent"
                    BorderColor="Red"
                    BorderWidth="1"
                    CornerRadius="5"
                    HeightRequest="45"
                    Clicked="btnCerrarSesion_Clicked"/>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>